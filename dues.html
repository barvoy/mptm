<h1>Join Menlo Park Toastmasters!</h1>
<p>
Join our club in 4 easy steps:

<ol>
<li>Pay a membership fee (below)
<li>Complete and sign <a target="_blank" href="mptm_new_member.pdf">the new member form</a> and send copy to our Treasurer: <a href="mailto:treasurer@menloparktm.org">treasurer@menloparktm.org</a>
<li>Join <a target="_blank" href="https://groups.google.com/forum/#!forum/mptm/join">our club's mailing list</a>. This is how we send speech details and our schedule.</li>
<li>Request a name tag from our Sergeant at Arms: <a href="mailto:saa@menloparktm.org?subject=MPTM TAG request: PUT_YOUR_FIRST_AND_LASTNAME_HERE">saa@menloparktm.org</a>
</ol>

</p>

<fieldset width="80%">
<legend>Membership options:</legend>
<p>
<b>Are you a new member?</b>
<br />
<form id="mptm_new_member">
  <input type="radio" class="mptm_new_member_dues" name="mptm_new_member" value="1" checked="true">yes ($20, initiation fee)<br/>
  <input type="radio" class="mptm_new_member_dues" name="mptm_new_member" value="0">no &nbsp;($0, renewal/reinstating)<br/>
</form>
</p>

<p>
<b>Month you'd like to start your membership</b><br />
<small>
  (pro-rated $10/month: $7.50/month to Toastmasters International 503c non-profit and $2.50/month for running our club):
</small>
<form id="mptm_dues">
  <input type="radio" class="mptm_months" name="mptm_months" value="3">January<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="2">February<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="1">March<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="6">April<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="5">May<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="4">June<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="3">July<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="2">August<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="1">September<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="6">October<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="5">November<br/>
  <input type="radio" class="mptm_months" name="mptm_months" value="4">December<br/>
</form>
</p>

<p>
<b>CA sales tax</b><br />
  <input type="radio" class="mptm_ca_tax" name="bleh" value="4" checked>$1.55<br/>
</p>
</fieldset>


<p>
<b>Summary:</b><br/>
<ul>
<li><span id="pay_expl_link"></span>
</ul>
</p>

<p>
<h3 id="mptm_total_pay">Total: </h3>
</p>

<p>
<a id="pay_link" href=""></a>
<br/>
<br/>
<i>NOTE: You'll be redirected to the PayPal website. Credit/debit cards and PayPal are accepted.</i>
</p>

<script>
function mptm_calc_dues(should_update_month) {
	const ca_sales_tax = 1.55;
	const mptm_monthly_fee = 2.50;
	const tmi_monthly_fee = 7.50;
	const new_member_fee = 20;

	const cur_date = new Date();
	const cur_month_day = cur_date.getDate();
	const month_maybe_inc = (cur_month_day > 14) ? 1 : 0;
	const toggle_month = (cur_date.getMonth() + month_maybe_inc) % 12;

	let mptm_months_el = document.getElementsByClassName('mptm_months');
	let mptm_new_member_dues = document.getElementsByClassName('mptm_new_member_dues');

	console.assert(mptm_months_el.length == 12, "internal error: we don't have 12 months");
	console.assert(toggle_month >= 0 && toggle_month <= 11, "we have a wrong month!");
	if (should_update_month) {
		mptm_months_el[toggle_month].checked = 'true';
	}

	let which_month_to_start = null;
	let how_many_months = null;
	let wi = 0;
	for (let mptm_month_el of mptm_months_el) {
		if (mptm_month_el.checked) {
			how_many_months = parseInt(mptm_month_el.value);
			which_month_to_start = wi;
			break;
		}
		wi += 1;
	}
	let is_new_member = null;
	for (let mptm_member_dues of mptm_new_member_dues) {
		if (mptm_member_dues.checked) {
			is_new_member = parseInt(mptm_member_dues.value);
		}
	}
	console.assert(how_many_months != null, "ops1");
	console.assert(is_new_member != null, "ops2");
	console.assert(which_month_to_start != null, "ops3");

	let to_pay = (mptm_monthly_fee + tmi_monthly_fee)*how_many_months
			+ (new_member_fee*is_new_member)
			+ ca_sales_tax;



	let mptm_total_pay_el = document.getElementById('mptm_total_pay');
	mptm_total_pay_el.innerHTML = "Total: $" + to_pay;

	let pay_link_el = document.getElementById('pay_link');
	pay_link_el.innerHTML = "Click HERE to pay $" + to_pay;
	pay_link_el.href = "https://paypal.me/mptm/" + to_pay;

	let tmpDate = new Date(cur_date.getFullYear(), which_month_to_start, 1);
	let start_month_name = tmpDate.toLocaleString("en-us", { month: "long" });

	let pay_expl_link_el = document.getElementById('pay_expl_link');
	pay_expl_link_el.innerHTML = how_many_months
		+ "-month membership in Menlo Park Toastmasters, starting "
		+ start_month_name
		+ " 1 ($" + (mptm_monthly_fee + tmi_monthly_fee)
		+ "/month): $" + ((mptm_monthly_fee+tmi_monthly_fee)*how_many_months)+ "<br/>"
		+ (is_new_member ? ("<li>New member initiation fee: $" + new_member_fee) : "")
		+ "<li>CA sales tax: $" + (ca_sales_tax)
		;

	//console.log(how_many_months, is_new_member);
}

let r1_el = document.getElementsByClassName('mptm_new_member_dues');
let r2_el = document.getElementsByClassName('mptm_months');

for (r_el of r1_el) {
	r_el.addEventListener('click', function() {
		mptm_calc_dues(false);
	});
}
for (r_el of r2_el) {
	r_el.addEventListener('click', function() {
		mptm_calc_dues(false);
	});
}

mptm_calc_dues(true);	// call it once to update a "checked" mark near the current month

</script>

<hr />
<small>
<center>Copyright &copy; 2018 W. Adam Koszek and <a href="http://www.barvoy.com">Barvoy LLC</a> (contact: <a href="mailto:wkoszek@koszek.com">wojciech@koszek.com</a>)</center>
</small>
